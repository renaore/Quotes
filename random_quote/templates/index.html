{% extends "base.html" %}

{% block content %}
<div style="text-align: center; margin: 50px auto; max-width: 800px;">
    <h1>–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞</h1>

    {% if quote %}
        <div style="background: #f8f9fa; padding: 30px; border-radius: 10px; margin: 30px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <blockquote style="font-size: 24px; line-height: 1.6; color: #333; font-style: italic;">
                "{{ quote.text }}"
            </blockquote>
            <p style="font-size: 18px; color: #666; margin-top: 20px; text-align: right;">
               ‚Äî {{ quote.source }}
            </p>
            <p>
                üëÅÔ∏è {{ quote.shows }} &nbsp;&nbsp; üëç <span id="like-count">{{ quote.likes }}</span>
                &nbsp;&nbsp; üëé <span id="dislike-count">{{ quote.dislikes }}</span>
            </p>
            <button id="like-button" style="background: #007bff; color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                Ô∏èüëç –ù—Ä–∞–≤–∏—Ç—Å—è
            </button>
            <button id="dislike-button" style="background: #007bff; color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                Ô∏èüëé –ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è
            </button>
        </div>
        <script>
function sendVote(action) {
    fetch("{% url 'vote' quote.id %}", {
        method: "POST",
        headers: {
            'X-CSRFToken': '{{ csrf_token }}',
            'Accept': 'application/json',
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: new URLSearchParams({action: action})
    })
    .then(response => response.json())
    .then(data => {
        if(data.status === 'success') {
            if(action === "like") {
                document.getElementById('like-count').textContent = data.likes;
                document.getElementById('like-button').disabled = true;
                document.getElementById('like-button').textContent = "üëç –õ–∞–π–∫ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω";
                document.getElementById('dislike-button').disabled = true; // –±–ª–æ–∫–∏—Ä—É–µ–º –¥–∏–∑–ª–∞–π–∫
            } else if(action === "dislike") {
                document.getElementById('dislike-count').textContent = data.dislikes;
                document.getElementById('dislike-button').disabled = true;
                document.getElementById('dislike-button').textContent = "üëé –î–∏–∑–ª–∞–π–∫ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω";
                document.getElementById('like-button').disabled = true; // –±–ª–æ–∫–∏—Ä—É–µ–º –ª–∞–π–∫
            }
        }
    })
}

document.getElementById('like-button').addEventListener('click', function() {
    sendVote("like");
});

document.getElementById('dislike-button').addEventListener('click', function() {
    sendVote("dislike");
});
        </script>
    {% else %}
        <div style="background: #f8f9fa; padding: 30px; border-radius: 10px; margin: 30px 0;">
            <p style="font-size: 18px; color: #666;">
                –¶–∏—Ç–∞—Ç –ø–æ–∫–∞ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —Ü–∏—Ç–∞—Ç—É!
            </p>
            <form action="{% url 'edit' %}" method="get">
                <button type="submit" style="background: #28a745; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 16px;">
                    –î–æ–±–∞–≤–∏—Ç—å —Ü–∏—Ç–∞—Ç—É
                </button>
            </form>
        </div>
    {% endif %}
    <div style="margin-top: 20px;">
        <form action="" method="get">
            <button type="submit" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                üîÑ –ù–æ–≤–∞—è —Å–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞
            </button>
        </form>
    </div>
</div>
{% endblock %}

